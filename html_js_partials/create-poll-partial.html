<script>
    function cancle(){
		window.location.replace(window.location.origin);
	}

    function submitt(){
		options = document.getElementsByClassName("option")
		optString = ""
        count = 0
		for(x in options){
			if(options[x].value){
				if(x != 0){
					optString += ","
				}
				optString += options[x].value
                count++;
			}
		}

        var question    = document.getElementById("question-input").value
        var pollName    = document.getElementById("poll-name-input").value
        var tokenNeeded = document.getElementById("token-needed-input").checked
        var multiChoice = document.getElementById("multi-possible-input").checked

        if(question == ""){
            alert("Must ask a question!")
            return
        }else if(count <= 1){
            alert("Must offer more than one option!")
            return
        }else if(pollName == ""){
            alert("Must have a poll-name!")
            return
        }
        
        var token = 0
        if(tokenNeeded){
            token = 1
        }

        var multiChoiceVar = 0
        if(multiChoice){
            multiChoiceVar = 1
        }

		window.location.href = window.location.origin + "/post-create?name=" + pollName
                        + "&options=" + optString
                        + "&" + "tokens=" + token 
                        + "&" + "multi=" + multiChoiceVar
                        + "&" + "q=" + question
	}

    function extend(){
		var span = document.createElement('span')
        span.innerText = "Answer: "
		var inputForm = document.createElement("input")
		inputForm.setAttribute("type", "text")
		inputForm.setAttribute("class", "option-input option")
		span.appendChild(inputForm)
		var element = document.getElementById("options-container")
        element.appendChild(span)
    }
</script>
<div id="main-container" class="main-container">
    <div class="main-title">
        Enter choices.
    <div>
	<div class="options-container" id="options-container">
		<span> Pollname: <input id="poll-name-input" type="text" class="option-input"> </span>
		<span> Question:  <input id="question-input"  type="text" class="option-input"> </span>
        <hr>
		<span> Answer: <input type="text" class="option-input option"> </span>
		<span> Answer: <input type="text" class="option-input option"> </span>
		<span> Answer: <input type="text" class="option-input option"> </span>
	</div>
    <hr>
	<div id="button-container" class="button-container">
        <span> Use Tokens? &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                <input class="vote-option" type=checkbox id="token-needed-input">
        </span>
        <span> Multiple Choice? &nbsp;&nbsp;&nbsp; 
                <input class="vote-option" type=checkbox id="multi-possible-input">
        </span>
	</div>
	
	<div id="button-container" class="button-container">
		<button onclick="extend()">+</button>
		<button onclick="submitt()">Create</button>
		<button onclick="cancle()">Cancle</button>
	</div>
</div>
<script>
    var url = new URL(window.location.href)
    var pollNameInput = document.getElementById('poll-name-input')
    var question = document.getElementById('question-input')
    var pollname = url.searchParams.get("name")

    if(pollname == "" || pollname == null){
        pollNameInput.focus();
        pollNameInput.select();
    }else{
        pollNameInput.value = pollname
        question.focus();
        question.select();
    }
</script>
